{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<h1 class="logo-text">
    Hello<span>    </span>
</h1>

{# --- Flash Messages --- #}
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="flash-messages" role="alert">
        {% for category, message in messages %}
        <div class="flash-message flash-{{ category }}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}
{% endwith %}

<div class="dashboard-content">
    <h2 class="dashboard-greeting">Welcome</h2>
    <div class="user-info">
        <p class="user-email">{{ user_email }}</p>
        {% if login_time %}
        <p class="login-time">Logged in at {{ login_time[:19] | replace('T', ' ') }} UTC</p>
        {% endif %}
    </div>

    {# Logout is POST-only to prevent CSRF via GET (e.g., <img src="/logout">). #}
    {# Per OWASP ASVS V3.3.1. #}
    <form action="{{ url_for('auth.logout') }}" method="POST">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <button type="submit" class="login-button logout-button">
            Logout
        </button>
    </form>
</div>
{% endblock %}
